# Pentecter Configuration
# Copy this file and customize:
#   cp config.example.yaml config.yaml
#
# This file combines knowledge base and blacklist settings.

# --- Knowledge Base ---
# Each entry points to a cloned repository's content directory.
# Setup:
#   git clone --depth 1 https://github.com/carlospolop/hacktricks.git ~/hacktricks
#
# Fields:
#   name: Identifier for the knowledge base
#   path: Path to the content directory (${VAR} expanded from host env)
knowledge:
  - name: hacktricks
    path: "${HOME}/hacktricks/src"

# --- Blacklist ---
# Dangerous command patterns blocked on host execution.
# Docker execution skips this check (isolated in container).
# Patterns use Go regexp syntax.
blacklist:
  # ファイルシステムの破壊的操作
  - 'rm\s+-rf\s+/'
  - 'rm\s+--no-preserve-root'
  - 'dd\s+if='
  - 'mkfs'
  - 'fdisk'
  - 'parted'

  # デバイスへの直接書き込み
  - '>\s*/dev/sd'
  - '>\s*/dev/nvme'
  - '>\s*/dev/hd'

  # システム停止
  - '\bshutdown\b'
  - '\breboot\b'
  - '\binit\s+0\b'
  - '\bpoweroff\b'

  # Windows 固有
  - 'format\s+[a-z]:'
  - 'del\s+/[sq]'

  # フォークボム
  - ':\(\)\{.*\|.*:.*\}'

# --- Recon Tree ---
# Controls structured reconnaissance behavior.
# max_parallel: Maximum concurrent recon tasks (default: 2)
#   Higher values speed up recon but increase load on target.
#   Use 1 for stealth, 2-3 for normal, 4+ for aggressive.
recon:
  max_parallel: 2

  # initial_scans: Commands to run automatically when a target is added.
  # Use {target} as placeholder for the target host/IP.
  # If omitted, the agent decides which scans to run.
  # initial_scans:
  #   - "nmap -p- -sV -Pn -oX - {target}"
  #   - "nmap -sU --top-ports 1000 -sV -Pn -oX - {target}"
